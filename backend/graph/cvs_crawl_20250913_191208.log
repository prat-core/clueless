2025-09-13 19:12:08,041 - __main__ - INFO - ============================================================
2025-09-13 19:12:08,041 - __main__ - INFO - CVS Website Crawler Test
2025-09-13 19:12:08,041 - __main__ - INFO - ============================================================
2025-09-13 19:12:08,041 - __main__ - INFO - Target URL: https://www.cvs.com
2025-09-13 19:12:08,042 - __main__ - INFO - Neo4j URI: bolt://localhost:7687
2025-09-13 19:12:08,042 - __main__ - INFO - Max Depth: 3
2025-09-13 19:12:08,042 - __main__ - INFO - Max Pages: 100
2025-09-13 19:12:08,042 - __main__ - INFO - ============================================================
2025-09-13 19:12:31,262 - __main__ - INFO - Clearing existing database...
2025-09-13 19:12:31,305 - neo4j_manager - INFO - Successfully connected to Neo4j at bolt://localhost:7687
2025-09-13 19:12:31,307 - neo4j_manager - INFO - Created constraint/index: page_url_unique
2025-09-13 19:12:31,308 - neo4j_manager - INFO - Created constraint/index: external_url_unique
2025-09-13 19:12:31,310 - neo4j_manager - INFO - Created constraint/index: page_domain
2025-09-13 19:12:31,311 - neo4j_manager - INFO - Created constraint/index: page_crawled
2025-09-13 19:12:31,312 - neo4j_manager - INFO - Created constraint/index: element_type
2025-09-13 19:12:31,317 - neo4j_manager - WARNING - Could not create constraint/index: {code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'VECTOR': expected "(", "ALL", "ANY" or "SHORTEST" (line 1, column 8 (offset: 7))
"CREATE VECTOR INDEX page_content_vector IF NOT EXISTS FOR (p:Page) ON p.content_vector OPTIONS {indexConfig: {`vector.dimensions`: 1536, `vector.similarity_function`: 'cosine'}}"
        ^}
2025-09-13 19:12:31,403 - neo4j_manager - INFO - Neo4j connection closed
2025-09-13 19:12:31,403 - __main__ - INFO - Database cleared
2025-09-13 19:12:31,403 - __main__ - INFO - Initializing web crawler...
2025-09-13 19:12:31,409 - neo4j_manager - INFO - Successfully connected to Neo4j at bolt://localhost:7687
2025-09-13 19:12:31,410 - neo4j_manager - INFO - Created constraint/index: page_url_unique
2025-09-13 19:12:31,412 - neo4j_manager - INFO - Created constraint/index: external_url_unique
2025-09-13 19:12:31,415 - neo4j_manager - INFO - Created constraint/index: page_domain
2025-09-13 19:12:31,418 - neo4j_manager - INFO - Created constraint/index: page_crawled
2025-09-13 19:12:31,420 - neo4j_manager - INFO - Created constraint/index: element_type
2025-09-13 19:12:31,424 - neo4j_manager - WARNING - Could not create constraint/index: {code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'VECTOR': expected "(", "ALL", "ANY" or "SHORTEST" (line 1, column 8 (offset: 7))
"CREATE VECTOR INDEX page_content_vector IF NOT EXISTS FOR (p:Page) ON p.content_vector OPTIONS {indexConfig: {`vector.dimensions`: 1536, `vector.similarity_function`: 'cosine'}}"
        ^}
2025-09-13 19:12:31,490 - content_processor - INFO - ContentProcessor initialized with OpenAI API
2025-09-13 19:12:31,507 - crawler - INFO - WebCrawler initialized for https://www.cvs.com
2025-09-13 19:12:31,507 - crawler - INFO - Base domain: www.cvs.com
2025-09-13 19:12:31,507 - __main__ - INFO - Starting crawl...
2025-09-13 19:12:31,508 - crawler - INFO - Starting crawl from https://www.cvs.com with max_pages=100, max_depth=3
2025-09-13 19:12:31,508 - crawler - INFO - Fetching URL: https://www.cvs.com
2025-09-13 19:12:31,683 - httpx - INFO - HTTP Request: GET https://www.cvs.com "HTTP/1.1 200 OK"
2025-09-13 19:12:32,406 - crawler - INFO - Successfully fetched https://www.cvs.com - Status: 200, Size: 15950785 bytes, Time: 862.35ms
2025-09-13 19:12:32,888 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 401 Unauthorized"
2025-09-13 19:12:32,888 - content_processor - ERROR - OpenAI API error on attempt 1/3: Error code: 401 - {'error': {'message': 'Incorrect API key provided: your-ope************here. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-09-13 19:12:33,987 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 401 Unauthorized"
2025-09-13 19:12:33,988 - content_processor - ERROR - OpenAI API error on attempt 2/3: Error code: 401 - {'error': {'message': 'Incorrect API key provided: your-ope************here. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-09-13 19:12:35,092 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 401 Unauthorized"
2025-09-13 19:12:35,093 - content_processor - ERROR - OpenAI API error on attempt 3/3: Error code: 401 - {'error': {'message': 'Incorrect API key provided: your-ope************here. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-09-13 19:12:35,093 - content_processor - ERROR - Failed to generate embedding after 3 attempts
2025-09-13 19:12:35,744 - crawler - INFO - Stored page data for https://www.cvs.com with 169 links
2025-09-13 19:12:35,749 - crawler - INFO - Progress: 1/100 pages crawled, 112 in queue
2025-09-13 19:12:37,250 - crawler - INFO - Fetching URL: https://www.cvs.com/rx/dotm/cart?flowType=FS
2025-09-13 19:12:37,285 - httpx - INFO - HTTP Request: GET https://www.cvs.com/rx/dotm/cart?flowType=FS "HTTP/1.1 403 Forbidden"
2025-09-13 19:12:37,285 - crawler - WARNING - HTTP error 403 for https://www.cvs.com/rx/dotm/cart?flowType=FS
2025-09-13 19:12:37,288 - crawler - INFO - Fetching URL: https://www.cvs.com/pharmacy/v3/dashboard
2025-09-13 19:12:37,353 - httpx - INFO - HTTP Request: GET https://www.cvs.com/pharmacy/v3/dashboard "HTTP/1.1 302 Moved Temporarily"
2025-09-13 19:12:37,414 - httpx - INFO - HTTP Request: GET https://www.cvs.com/pharmacy/rx/prescriptions "HTTP/1.1 200 OK"
2025-09-13 19:12:37,466 - crawler - INFO - Successfully fetched https://www.cvs.com/pharmacy/v3/dashboard - Status: 200, Size: 1917568 bytes, Time: 175.50ms
2025-09-13 19:12:37,623 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 401 Unauthorized"
2025-09-13 19:12:37,624 - content_processor - ERROR - OpenAI API error on attempt 1/3: Error code: 401 - {'error': {'message': 'Incorrect API key provided: your-ope************here. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-09-13 19:12:38,663 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 401 Unauthorized"
2025-09-13 19:12:38,672 - content_processor - ERROR - OpenAI API error on attempt 2/3: Error code: 401 - {'error': {'message': 'Incorrect API key provided: your-ope************here. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-09-13 19:12:39,716 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 401 Unauthorized"
2025-09-13 19:12:39,717 - content_processor - ERROR - OpenAI API error on attempt 3/3: Error code: 401 - {'error': {'message': 'Incorrect API key provided: your-ope************here. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-09-13 19:12:39,717 - content_processor - ERROR - Failed to generate embedding after 3 attempts
2025-09-13 19:12:40,121 - crawler - INFO - Stored page data for https://www.cvs.com/pharmacy/rx/prescriptions with 106 links
2025-09-13 19:12:40,122 - crawler - INFO - Progress: 2/100 pages crawled, 110 in queue
2025-09-13 19:12:41,622 - crawler - INFO - Fetching URL: https://www.cvs.com/photo/photo-landing
2025-09-13 19:12:42,239 - httpx - INFO - HTTP Request: GET https://www.cvs.com/photo/photo-landing "HTTP/1.1 200 OK"
2025-09-13 19:12:42,240 - crawler - INFO - Successfully fetched https://www.cvs.com/photo/photo-landing - Status: 200, Size: 175470 bytes, Time: 618.07ms
2025-09-13 19:12:42,462 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 401 Unauthorized"
2025-09-13 19:12:42,463 - content_processor - ERROR - OpenAI API error on attempt 1/3: Error code: 401 - {'error': {'message': 'Incorrect API key provided: your-ope************here. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-09-13 19:12:43,548 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 401 Unauthorized"
2025-09-13 19:12:43,548 - content_processor - ERROR - OpenAI API error on attempt 2/3: Error code: 401 - {'error': {'message': 'Incorrect API key provided: your-ope************here. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-09-13 19:12:44,435 - neo4j_manager - INFO - Neo4j connection closed
2025-09-13 19:12:44,436 - crawler - INFO - WebCrawler resources cleaned up
2025-09-13 19:12:44,436 - __main__ - INFO - 
Crawl interrupted by user
